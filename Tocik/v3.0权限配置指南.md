# v3.0 新增权限配置指南

## 📱 新增功能需要的权限

v3.0增加了17个新功能，部分功能需要额外的系统权限。

---

## ⚙️ 必须在Xcode中配置

### 打开项目
```bash
cd /Users/macchuzu/Documents/Tocik
open Tocik.xcodeproj
```

### 配置步骤

1. 选择项目 **Tocik** → **TARGETS** → **Tocik**
2. 选择 **Info** 标签
3. 在 **Custom iOS Target Properties** 中点击 **+** 添加以下权限

---

## 📸 相机权限（二维码 + 错题本）

| Key | Type | Value |
|-----|------|-------|
| Privacy - Camera Usage Description | String | 需要相机权限以扫描二维码和拍摄错题照片 |

**用途**:
- 二维码工具：扫描二维码
- 错题本：拍摄错题照片

---

## 🎤 麦克风权限（语音备忘录）

| Key | Type | Value |
|-----|------|-------|
| Privacy - Microphone Usage Description | String | 需要麦克风权限以录制语音备忘录 |

**用途**:
- 语音备忘录：录制音频

---

## 🗣 语音识别权限（可选）

| Key | Type | Value |
|-----|------|-------|
| Privacy - Speech Recognition Usage Description | String | 需要语音识别权限以将录音转换为文字 |

**用途**:
- 语音备忘录：语音转文字（待实现）

---

## 📷 照片库权限（二维码 + 错题本）

| Key | Type | Value |
|-----|------|-------|
| Privacy - Photo Library Usage Description | String | 需要访问相册以选择图片和保存二维码 |
| Privacy - Photo Library Additions Usage Description | String | 需要保存图片到相册 |

**用途**:
- 错题本：选择照片
- 二维码：保存生成的二维码

---

## ✅ 完整权限列表

### 原有权限（v1.0-v2.0）
- ✅ Privacy - Location When In Use Usage Description

### 新增权限（v3.0）
- ⚠️ Privacy - Camera Usage Description
- ⚠️ Privacy - Microphone Usage Description
- ⚠️ Privacy - Speech Recognition Usage Description（可选）
- ⚠️ Privacy - Photo Library Usage Description
- ⚠️ Privacy - Photo Library Additions Usage Description

---

## 🎯 配置后的功能可用性

### 配置相机权限后可用
- ✅ 二维码扫描（需进一步实现AVCaptureSession）
- ✅ 错题本拍照

### 配置麦克风权限后可用
- ✅ 语音备忘录录音

### 配置照片库权限后可用
- ✅ 错题本选择照片
- ✅ 二维码保存到相册

### 配置语音识别权限后可用（可选）
- 语音转文字（待实现Speech框架集成）

---

## 📝 配置示例

### 在Xcode Info标签中的配置

```
Custom iOS Target Properties
├─ Privacy - Location When In Use Usage Description
│  └─ 需要获取您的位置信息以提供天气预报服务
├─ Privacy - Camera Usage Description
│  └─ 需要相机权限以扫描二维码和拍摄错题照片
├─ Privacy - Microphone Usage Description
│  └─ 需要麦克风权限以录制语音备忘录
├─ Privacy - Speech Recognition Usage Description
│  └─ 需要语音识别权限以将录音转换为文字
├─ Privacy - Photo Library Usage Description
│  └─ 需要访问相册以选择图片和保存二维码
└─ Privacy - Photo Library Additions Usage Description
   └─ 需要保存图片到相册
```

---

## ⚡️ 快速配置步骤

### 方法1：逐个添加（推荐）
1. Xcode → 选择Target
2. Info标签 → 点击 **+**
3. 输入Key名称
4. 选择Type为String
5. 输入Value描述
6. 重复添加所有权限

### 方法2：批量配置
可以在项目的Info.plist源代码中直接编辑（高级用户）

---

## 🔍 权限请求时机

### 自动请求
- **通知权限** - 应用启动时
- **位置权限** - 打开天气Tab时

### 按需请求
- **相机权限** - 扫描二维码时
- **麦克风权限** - 开始录音时
- **语音识别权限** - 转文字时（待实现）
- **照片库权限** - 选择照片时

---

## ⚠️ 注意事项

### 模拟器测试
- 相机功能在模拟器不可用
- 需要真机测试二维码扫描
- 麦克风在模拟器可能不稳定

### 权限被拒绝
如果用户拒绝权限：
- 应用会显示友好提示
- 引导用户到设置中开启
- 其他功能不受影响

### 隐私合规
所有权限描述已使用中文
- 符合App Store审核要求
- 清楚说明用途
- 保护用户隐私

---

## ✅ 配置验证

配置完成后：
1. 清理构建：⌘ + Shift + K
2. 重新构建：⌘ + B
3. 运行应用：⌘ + R
4. 测试权限请求

---

## 🎉 配置完成后

您将拥有：
- ✅ 30个功能模块
- ✅ 完整的权限系统
- ✅ 所有功能正常工作
- ✅ 符合App Store要求

**开始体验完整版Tocik v3.0吧！** 🚀

---

创建日期：2025年10月23日
版本：3.0
配置难度：简单（5分钟）

